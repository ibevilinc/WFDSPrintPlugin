#! /bin/bash
# (c) Copyright 2013 Hewlett-Packard Development Company, L.P.
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
# http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# determine output directory
if [ -d /work/$USER ]; then
    OUTPUT_DIR_BASE=/work/$USER/ppm_test
else
    OUTPUT_DIR_BASE=$HOME/tmp/ppm_test
fi

export TEST_DATE=`date +%Y%m%d-%H%M`

OUTTDIR=$OUTPUT_DIR_BASE/$TEST_DATE


if [ -d $OUTTDIR ]; then
    echo "using: " $OUTTDIR
else
    mkdir -p $OUTTDIR
fi


MEDIA_SIZE=2
RESOLUTION=300
#default test type is PPM
TEST_TYPE=0


# INTESTFILE=$1
# process the command line arguments
while getopts "m:i:e:x:p:" option
do
    case $option in
    m ) 
        MEDIA_SIZE=$OPTARG
	;;
    i )
	INTESTFILE=$OPTARG
	;;
    e )
	EXTRA_PARAMS=$OPTARG
	;;
	x )
	RESOLUTION=$OPTARG
	;;
	p )
	TEST_TYPE=$OPTARG
	;;
esac
done

if [ $TEST_TYPE -eq 0 ]; then
	TEST_EXT=.ppm
elif [ $TEST_TYPE -eq 1 ]; then
	TEST_EXT=.pdf
elif [ $TEST_TYPE -eq 2 ]; then
	TEST_EXT=.ras	
fi

OUTFILE=`basename $INTESTFILE`
LOGFILE=$OUTTDIR/${OUTFILE}
        


PPM_TEST_LETTER[0]="-l ${LOGFILE}_F39_E3_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 3 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E3_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[1]="-l ${LOGFILE}_F39_E7_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 7 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E7_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[2]="-l ${LOGFILE}_F39_E15_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 15 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E15_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[3]="-l ${LOGFILE}_F39_E3_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 3 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E3_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[4]="-l ${LOGFILE}_F39_E7_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 7 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E7_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[5]="-l ${LOGFILE}_F39_E15_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 15 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E15_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[6]="-l ${LOGFILE}_F39_E3_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 3 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E3_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[7]="-l ${LOGFILE}_F39_E7_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 7 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E7_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[8]="-l ${LOGFILE}_F39_E15_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 15 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E15_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[9]="-l ${LOGFILE}_F39_E3_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 3 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E3_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[10]="-l ${LOGFILE}_F39_E7_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 7 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E7_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[11]="-l ${LOGFILE}_F39_E15_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 39 - e 15 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F39_E15_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[12]="-l ${LOGFILE}_F71_E3_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 3 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E3_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[13]="-l ${LOGFILE}_F71_E7_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 7 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E7_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[14]="-l ${LOGFILE}_F71_E15_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 15 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E15_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[15]="-l ${LOGFILE}_F71_E3_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 3 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E3_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[16]="-l ${LOGFILE}_F71_E7_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 7 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E7_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[17]="-l ${LOGFILE}_F71_E15_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 15 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E15_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[18]="-l ${LOGFILE}_F71_E3_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 3 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E3_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[19]="-l ${LOGFILE}_F71_E7_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 7 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E7_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[20]="-l ${LOGFILE}_F71_E15_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 15 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E15_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[21]="-l ${LOGFILE}_F71_E3_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 3 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E3_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[22]="-l ${LOGFILE}_F71_E7_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 7 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E7_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[23]="-l ${LOGFILE}_F71_E15_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 71 - e 15 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F71_E15_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[24]="-l ${LOGFILE}_F327_E3_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 3 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E3_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[25]="-l ${LOGFILE}_F327_E7_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 7 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E7_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[26]="-l ${LOGFILE}_F327_E15_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 15 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E15_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[27]="-l ${LOGFILE}_F327_E3_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 3 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E3_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[28]="-l ${LOGFILE}_F327_E7_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 7 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E7_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[29]="-l ${LOGFILE}_F327_E15_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 15 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E15_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[30]="-l ${LOGFILE}_F327_E3_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 3 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E3_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[31]="-l ${LOGFILE}_F327_E7_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 7 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E7_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[32]="-l ${LOGFILE}_F327_E15_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 15 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E15_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[34]="-l ${LOGFILE}_F327_E3_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 3 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E3_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[35]="-l ${LOGFILE}_F327_E7_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 7 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E7_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[36]="-l ${LOGFILE}_F327_E15_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 327 - e 15 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F327_E15_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[37]="-l ${LOGFILE}_F577_E3_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 3 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E3_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[38]="-l ${LOGFILE}_F577_E7_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 7 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E7_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[39]="-l ${LOGFILE}_F577_E15_R0_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 15 -r 0  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E15_R0_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[40]="-l ${LOGFILE}_F577_E3_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 3 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E3_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[41]="-l ${LOGFILE}_F577_E7_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 7 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E7_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[42]="-l ${LOGFILE}_F577_E15_R1_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 15 -r 1  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E15_R1_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[43]="-l ${LOGFILE}_F577_E3_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 3 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E3_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[44]="-l ${LOGFILE}_F577_E7_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 7 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E7_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[45]="-l ${LOGFILE}_F577_E15_R2_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 15 -r 2  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E15_R2_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

PPM_TEST_LETTER[46]="-l ${LOGFILE}_F577_E3_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 3 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E3_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[47]="-l ${LOGFILE}_F577_E7_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 7 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E7_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"
PPM_TEST_LETTER[48]="-l ${LOGFILE}_F577_E15_R3_M${MEDIA_SIZE}_X${RESOLUTION}.log -m$MEDIA_SIZE -f 577 - e 15 -r 3  -p $TEST_TYPE -i $INTESTFILE -o $OUTTDIR/${OUTFILE}_F577_E15_R3_M${MEDIA_SIZE}_X${RESOLUTION}$TEST_EXT"

	
ABSPATH=$(cd ${0%/*} && echo $PWD/${0##*/})

# to get the path only - not the script name - add
PATHONLY=`dirname "$ABSPATH"`

echo "Test output located at: $OUTTDIR"

for mytest in ${!PPM_TEST_LETTER[*]}
do
	$PATHONLY/scalerTest  ${PPM_TEST_LETTER[$mytest]}
done

